version: '3'

vars:
  REQUIRED_TOOLS_LIST: kubectl
  K8S_DISTRO_NAME: 'EKS Anywhere (EKSA)'

tasks:

  default:
  - task: :helpers:validate
    vars:
      REQUIRED_TOOLS_LIST: "{{.REQUIRED_TOOLS_LIST}}"

  init:
    deps: [default]
    vars:
      K8S_CLUSTER_CONTEXT:
        sh: kubectl config view -o jsonpath='{range .contexts[*]}{.name}{"\n"}{end}' | gum filter --placeholder "Select Target {{.K8S_DISTRO_NAME}} Cluster..."
    cmds:
    - kubectl config use-context {{.K8S_CLUSTER_CONTEXT}}
